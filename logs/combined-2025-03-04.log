{"level":"info","message":"Inizializzazione modelli in corso...","timestamp":"2025-03-04T08:33:05.255Z"}
{"level":"info","message":"Tutti i modelli sono stati caricati con successo","timestamp":"2025-03-04T08:33:05.285Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-00.4nf56.mongodb.net","timestamp":"2025-03-04T08:33:05.897Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T08:33:05.898Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T08:33:05.899Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T08:33:06.179Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T08:33:06.182Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T08:33:06.182Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-04T08:33:42.242Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-04T08:33:42.243Z"}
{"duration":"9ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741077222238_0at9v9fqt","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T08:33:42.247Z","url":"/api/v1/auth/verify","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-04T08:33:42.253Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T08:33:42.253Z"}
{"duration":"5ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741077222250_yjrrnygoc","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T08:33:42.255Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"},"timestamp":"2025-03-04T11:44:27.549Z","userId":"67c02995250c5746c3d9647c"}
<<<<<<< HEAD
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T17:08:23.278Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T17:08:23.280Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T17:08:23.303Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-00.4nf56.mongodb.net","timestamp":"2025-03-04T17:08:23.868Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T17:08:23.869Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T17:08:23.870Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T17:08:24.114Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T17:08:24.116Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T17:08:24.117Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-04T17:09:00.698Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-04T17:09:00.699Z"}
{"duration":"8ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741108140694_bf9jydpnq","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T17:09:00.702Z","url":"/api/v1/auth/verify","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-04T17:09:00.707Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T17:09:00.708Z"}
{"duration":"4ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741108140705_pefvlkbbl","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T17:09:00.709Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T20:42:45.173Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T20:42:45.176Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T20:42:45.198Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-01.4nf56.mongodb.net","timestamp":"2025-03-04T20:42:45.768Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T20:42:45.769Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T20:42:45.770Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T20:42:46.042Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T20:42:46.045Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T20:42:46.045Z"}
=======
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T17:00:54.853Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T17:00:54.860Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T17:00:54.920Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-01.4nf56.mongodb.net","timestamp":"2025-03-04T17:00:56.012Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T17:00:56.013Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T17:00:56.014Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T17:00:56.363Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T17:00:56.369Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T17:00:56.370Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-04T17:01:22.049Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-04T17:01:22.051Z"}
{"duration":"14ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741107682043_fsxd4g27c","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T17:01:22.058Z","url":"/api/v1/auth/verify","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-04T17:01:22.075Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T17:01:22.076Z"}
{"duration":"8ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741107682071_t0rcrt9zy","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T17:01:22.079Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"},"timestamp":"2025-03-04T17:03:08.124Z","userId":"677bfe44f6789c907c9f3766"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/","timestamp":"2025-03-04T18:07:31.806Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"limit":"25","page":"1","search":"","sort":"-createdAt"},"requestId":"req_1741111651800_rr3eta5dt","timestamp":"2025-03-04T18:07:31.810Z","url":"/api/v1/users?page=1&limit=25&search=&sort=-createdAt"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-04T18:07:31.812Z"}
{"duration":"16ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741111651800_rr3eta5dt","responseSize":"160 Bytes","statusCode":500,"timestamp":"2025-03-04T18:07:31.817Z","url":"/api/v1/users?page=1&limit=25&search=&sort=-createdAt","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/","timestamp":"2025-03-04T18:51:03.038Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"institutionType":"","limit":"10","page":"1","populate":"manager","region":"","schoolType":""},"requestId":"req_1741114262826_peclspzu9","timestamp":"2025-03-04T18:51:03.151Z","url":"/api/v1/schools?page=1&limit=10&populate=manager&region=&schoolType=&institutionType="}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-04T18:51:03.153Z"}
{"duration":"366ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741114262826_peclspzu9","responseSize":"160 Bytes","statusCode":500,"timestamp":"2025-03-04T18:51:03.204Z","url":"/api/v1/schools?page=1&limit=10&populate=manager&region=&schoolType=&institutionType=","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/","timestamp":"2025-03-04T18:51:04.946Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"limit":"25","page":"1","search":"","sort":"-createdAt"},"requestId":"req_1741114264940_q9hgefb8l","timestamp":"2025-03-04T18:51:04.949Z","url":"/api/v1/users?page=1&limit=25&search=&sort=-createdAt"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-04T18:51:04.950Z"}
{"duration":"13ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741114264940_q9hgefb8l","responseSize":"160 Bytes","statusCode":500,"timestamp":"2025-03-04T18:51:04.953Z","url":"/api/v1/users?page=1&limit=25&search=&sort=-createdAt","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-04T18:51:18.553Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-04T18:51:18.555Z"}
{"duration":"24ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741114278544_73yds8hb6","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T18:51:18.569Z","url":"/api/v1/auth/verify","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-04T18:51:18.585Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T18:51:18.586Z"}
{"duration":"10ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741114278579_uobvp0n2u","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T18:51:18.590Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"},"timestamp":"2025-03-04T18:51:21.010Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T18:58:02.293Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T18:58:02.300Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T18:58:02.353Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-02.4nf56.mongodb.net","timestamp":"2025-03-04T18:58:03.327Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T18:58:03.329Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T18:58:03.330Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T18:58:03.703Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T18:58:03.711Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T18:58:03.712Z"}
{"error":"Impossibile archiviare l'unico anno accademico disponibile","level":"error","message":"Errore nell'archiviazione dell'anno accademico","schoolId":"679fdad474255ebc8afab683","timestamp":"2025-03-04T19:10:00.363Z","yearId":"679fdad474255ebc8afab684"}
{"error":"Impossibile archiviare l'unico anno accademico disponibile","level":"error","message":"Errore nell'archiviazione dell'anno accademico","schoolId":"679fdad474255ebc8afab683","timestamp":"2025-03-04T19:10:00.364Z","yearId":"679fdad474255ebc8afab684"}
{"duration":"241ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741115400127_5ugrvrkgx","responseSize":"116 Bytes","statusCode":500,"timestamp":"2025-03-04T19:10:00.370Z","url":"/api/v1/schools/679fdad474255ebc8afab683/academic-years/679fdad474255ebc8afab684/archive","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T19:26:16.679Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T19:26:16.684Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T19:26:16.752Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-00.4nf56.mongodb.net","timestamp":"2025-03-04T19:26:17.811Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T19:26:17.812Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T19:26:17.814Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T19:26:18.159Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T19:26:18.170Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T19:26:18.171Z"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T19:27:48.308Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T19:27:48.312Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T19:27:48.349Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-01.4nf56.mongodb.net","timestamp":"2025-03-04T19:27:49.203Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T19:27:49.204Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T19:27:49.206Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T19:27:49.478Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T19:27:49.482Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T19:27:49.483Z"}
{"academicYear":"2025/2026","count":5,"level":"info","message":"Created classes for new academic year:","sectionsUsed":["A"],"timestamp":"2025-03-04T19:34:09.459Z"}
{"level":"info","message":"Anno accademico creato con successo","schoolId":"679fdad474255ebc8afab683","timestamp":"2025-03-04T19:34:09.510Z","year":"2025/2026"}
{"error":"Errori di validazione","level":"error","message":"Student route error:","method":"POST","path":"/batch-assign","timestamp":"2025-03-04T19:44:04.520Z","userId":"677bfe44f6789c907c9f3766"}
{"duration":"217ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741117444310_vwxgzjrtn","responseSize":"135 Bytes","statusCode":400,"timestamp":"2025-03-04T19:44:04.528Z","url":"/api/v1/students/batch-assign","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"code":"AUTH_005","level":"error","message":"Solo i docenti possono accedere a questa risorsa","metadata":{},"status":403,"timestamp":"2025-03-04T19:44:07.957Z"}
{"error":"Solo i docenti possono accedere a questa risorsa","level":"error","message":"Student route error:","method":"GET","path":"/my-students","timestamp":"2025-03-04T19:44:07.958Z","userId":"677bfe44f6789c907c9f3766"}
{"body":{},"error":{"message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741117447805_qdnqeoy1c","timestamp":"2025-03-04T19:44:07.966Z","url":"/api/v1/students/my-students"}
{"level":"error","message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-03-04T19:44:07.968Z"}
{"duration":"169ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741117447805_qdnqeoy1c","responseSize":"1.25 KB","statusCode":500,"timestamp":"2025-03-04T19:44:07.974Z","url":"/api/v1/students/my-students","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":"Parametro di ricerca richiesto","level":"error","message":"Student route error:","method":"GET","path":"/search","timestamp":"2025-03-04T19:44:17.205Z","userId":"677bfe44f6789c907c9f3766"}
{"duration":"155ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741117457053_nnuus0jpk","responseSize":"84 Bytes","statusCode":400,"timestamp":"2025-03-04T19:44:17.208Z","url":"/api/v1/students/search","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T20:05:30.794Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T20:05:30.799Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T20:05:30.845Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-01.4nf56.mongodb.net","timestamp":"2025-03-04T20:05:31.794Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T20:05:31.796Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T20:05:31.797Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T20:05:32.131Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T20:05:32.138Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T20:05:32.139Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/67c236a42373b42426264bf6/classes","timestamp":"2025-03-04T20:09:18.103Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"academicYear":"2024/2025"},"requestId":"req_1741118958098_b53kpk9l1","timestamp":"2025-03-04T20:09:18.105Z","url":"/api/v1/schools/67c236a42373b42426264bf6/classes?academicYear=2024/2025"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-04T20:09:18.106Z"}
{"duration":"16ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741118958098_b53kpk9l1","responseSize":"160 Bytes","statusCode":500,"timestamp":"2025-03-04T20:09:18.115Z","url":"/api/v1/schools/67c236a42373b42426264bf6/classes?academicYear=2024/2025","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/67c236a42373b42426264bf6/classes","timestamp":"2025-03-04T20:09:20.058Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"academicYear":"2024/2025"},"requestId":"req_1741118960052_2k7xdb3n1","timestamp":"2025-03-04T20:09:20.060Z","url":"/api/v1/schools/67c236a42373b42426264bf6/classes?academicYear=2024/2025"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-04T20:09:20.061Z"}
{"duration":"11ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741118960052_2k7xdb3n1","responseSize":"160 Bytes","statusCode":500,"timestamp":"2025-03-04T20:09:20.064Z","url":"/api/v1/schools/67c236a42373b42426264bf6/classes?academicYear=2024/2025","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-04T20:09:25.191Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-04T20:09:25.192Z"}
{"duration":"5ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741118965188_346883ud4","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T20:09:25.194Z","url":"/api/v1/auth/verify","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-04T20:09:25.201Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T20:09:25.203Z"}
{"duration":"7ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741118965198_vi2qhm4n8","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T20:09:25.205Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"},"timestamp":"2025-03-04T20:09:26.847Z","userId":"677bfe44f6789c907c9f3766"}
{"duplicates":0,"errors":0,"failed":0,"imported":1,"level":"info","message":"Bulk import with class completed successfully","timestamp":"2025-03-04T20:11:17.741Z"}
<<<<<<< HEAD
{"academicYear":"2024/2025","level":"info","message":"Inizializzazione classi per la scuola","schoolId":"67c763375b0426e1cb851fea","sectionsCount":1,"timestamp":"2025-03-04T20:31:51.891Z"}
{"classesCreated":5,"level":"info","message":"Classi iniziali create con successo","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-04T20:31:52.371Z"}
{"level":"info","message":"Manager rimosso con successo e assignedSchoolIds aggiornato","oldManagerId":"677bfe44f6789c907c9f3766","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-04T20:32:07.238Z","wasAlsoUser":false}
{"level":"info","message":"Manager rimosso con successo","oldManagerId":"677bfe44f6789c907c9f3766","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-04T20:32:07.239Z","updatedSchool":"67c763375b0426e1cb851fea"}
{"level":"info","message":"Manager aggiunto con successo con assignedSchoolIds aggiornato","newManagerId":"67c5e8191af6a34321b52006","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-04T20:32:12.841Z"}
{"level":"info","message":"Manager aggiunto con successo","newManagerId":"67c5e8191af6a34321b52006","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-04T20:32:12.842Z","updatedSchool":"67c763375b0426e1cb851fea"}
{"classId":"679fdad474255ebc8afab6a3","level":"info","message":"Studenti rimossi dalla classe","studentCount":1,"timestamp":"2025-03-04T20:42:45.690Z"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T20:47:44.314Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T20:47:44.319Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T20:47:44.379Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-02.4nf56.mongodb.net","timestamp":"2025-03-04T20:47:46.212Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T20:47:46.214Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T20:47:46.215Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T20:47:46.586Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T20:47:46.595Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T20:47:46.596Z"}
{"classId":"679fdad474255ebc8afab6a4","level":"info","message":"Studenti rimossi dalla classe","studentCount":1,"timestamp":"2025-03-04T20:48:15.193Z"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T20:51:36.528Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T20:51:36.532Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T20:51:36.575Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-02.4nf56.mongodb.net","timestamp":"2025-03-04T20:51:37.474Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T20:51:37.475Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T20:51:37.476Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T20:51:37.802Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T20:51:37.806Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T20:51:37.807Z"}
{"cascade":true,"error":{},"level":"error","message":"Error in delete student:","studentId":"679c7494bdb941a2c47766c8","timestamp":"2025-03-04T20:52:21.515Z"}
{"level":"error","message":"Error deleting student:","timestamp":"2025-03-04T20:52:21.517Z"}
{"error":"Class constructor ObjectId cannot be invoked without 'new'","level":"error","message":"Student route error:","method":"DELETE","path":"/679c7494bdb941a2c47766c8","stack":"TypeError: Class constructor ObjectId cannot be invoked without 'new'\n    at StudentRepository.delete (C:\\Users\\ricca\\Desktop\\BSc\\src\\repositories\\StudentRepository.js:968:74)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async StudentController.delete (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\studentController.js:475:13)","timestamp":"2025-03-04T20:52:21.517Z","userId":"677bfe44f6789c907c9f3766"}
{"duration":"175ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"DELETE","requestId":"req_1741121541344_rhb4437t2","responseSize":"112 Bytes","statusCode":400,"timestamp":"2025-03-04T20:52:21.519Z","url":"/api/v1/students/679c7494bdb941a2c47766c8?cascade=true","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T20:54:30.824Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T20:54:30.828Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T20:54:30.877Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-00.4nf56.mongodb.net","timestamp":"2025-03-04T20:54:31.710Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T20:54:31.711Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T20:54:31.713Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T20:54:32.041Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T20:54:32.045Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T20:54:32.045Z"}
{"level":"warn","message":"Route not found:","method":"GET","path":"/api/v1/users/67c5e8191af6a34321b52006/history","timestamp":"2025-03-04T21:05:51.474Z"}
{"duration":"158ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741122351317_m6gddz85g","responseSize":"95 Bytes","statusCode":404,"timestamp":"2025-03-04T21:05:51.475Z","url":"/api/v1/users/67c5e8191af6a34321b52006/history","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/67c5e8191af6a34321b52006/history","timestamp":"2025-03-04T21:09:56.252Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741122596237_109mtizu1","timestamp":"2025-03-04T21:09:56.253Z","url":"/api/v1/users/67c5e8191af6a34321b52006/history"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-04T21:09:56.258Z"}
{"duration":"31ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741122596237_109mtizu1","responseSize":"160 Bytes","statusCode":500,"timestamp":"2025-03-04T21:09:56.268Z","url":"/api/v1/users/67c5e8191af6a34321b52006/history","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-04T21:13:11.589Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-04T21:13:11.604Z"}
{"duration":"44ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741122791566_orjt1cjem","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T21:13:11.612Z","url":"/api/v1/auth/verify","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-04T21:13:11.624Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T21:13:11.625Z"}
{"duration":"7ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741122791621_k8w3vwoq2","responseSize":"144 Bytes","statusCode":500,"timestamp":"2025-03-04T21:13:11.628Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"},"timestamp":"2025-03-04T21:13:14.742Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"warn","message":"Route not found:","method":"GET","path":"/api/v1/users/67c5e8191af6a34321b52006/history","timestamp":"2025-03-04T21:13:24.405Z"}
{"duration":"166ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741122804241_mkg8uli0v","responseSize":"95 Bytes","statusCode":404,"timestamp":"2025-03-04T21:13:24.407Z","url":"/api/v1/users/67c5e8191af6a34321b52006/history","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T21:18:16.119Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T21:18:16.123Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T21:18:16.165Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-00.4nf56.mongodb.net","timestamp":"2025-03-04T21:18:17.932Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T21:18:17.933Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T21:18:17.934Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T21:18:18.423Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T21:18:18.434Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T21:18:18.435Z"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:18:26.816Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:18:26.817Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:20:53.558Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:20:53.559Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:21:05.220Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:21:05.221Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":6395,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:21:29.681Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6395,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:21:29.683Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T21:26:46.123Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T21:26:46.130Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T21:26:46.174Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-00.4nf56.mongodb.net","timestamp":"2025-03-04T21:26:47.068Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T21:26:47.069Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T21:26:47.070Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T21:26:47.432Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T21:26:47.441Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T21:26:47.442Z"}
{"error":{"message":"Token non più valido","metadata":{}},"level":"error","message":"Logout error","timestamp":"2025-03-04T21:26:51.673Z"}
{"error":{"message":"Token non più valido","metadata":{}},"level":"error","message":"Logout failed","timestamp":"2025-03-04T21:26:51.674Z"}
{"error":{},"level":"error","message":"Auth Route Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T21:26:51.675Z"}
{"error":{},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T21:26:51.676Z","userId":"677bfe44f6789c907c9f3766"}
{"duration":"343ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741123611378_vwkbh3hhh","responseSize":"401 Bytes","statusCode":500,"timestamp":"2025-03-04T21:26:51.809Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"},"timestamp":"2025-03-04T21:26:55.618Z","userId":"677bfe44f6789c907c9f3766"}
{"action":"login","level":"info","message":"User audit record created","timestamp":"2025-03-04T21:26:55.640Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6404,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:27:08.670Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6404,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:27:08.671Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T21:30:34.752Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T21:30:34.756Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T21:30:34.796Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-02.4nf56.mongodb.net","timestamp":"2025-03-04T21:30:35.651Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T21:30:35.652Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T21:30:35.653Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T21:30:35.999Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T21:30:36.004Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T21:30:36.004Z"}
{"entriesCount":6406,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:30:46.807Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6406,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:30:46.809Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T21:34:13.795Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T21:34:13.801Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T21:34:13.847Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-01.4nf56.mongodb.net","timestamp":"2025-03-04T21:34:15.554Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T21:34:15.555Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T21:34:15.556Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T21:34:15.867Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T21:34:15.875Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T21:34:15.876Z"}
{"entriesCount":6410,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:34:27.525Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6410,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:34:27.527Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6417,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:36:52.411Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6417,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:36:52.413Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":2,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:39:43.955Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":2,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:39:43.956Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":4,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:39:48.730Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":4,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:39:48.730Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:39:58.913Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":6,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:39:58.914Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":8,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:40:09.476Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":8,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:40:09.477Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":16,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:40:25.818Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":16,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:40:25.819Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"warn","message":"Mongoose not connected when initializing models","timestamp":"2025-03-04T21:41:17.918Z"}
{"connectionState":0,"existingModels":["CSIQuestion","Test","Student","CSIConfig"],"level":"info","message":"Initializing models...","timestamp":"2025-03-04T21:41:17.924Z"}
{"level":"info","message":"Model validation successful - all required models registered","timestamp":"2025-03-04T21:41:17.967Z"}
{"level":"info","message":"MongoDB Connected: cluster0-shard-00-02.4nf56.mongodb.net","timestamp":"2025-03-04T21:41:18.921Z"}
{"level":"info","message":"Database connesso con successo","timestamp":"2025-03-04T21:41:18.922Z"}
{"level":"info","message":"Tutti i modelli richiesti sono registrati correttamente","timestamp":"2025-03-04T21:41:18.924Z"}
{"environment":"development","level":"info","message":"Routes initialized:","protected":["/classes","/schools","/users","/students","/tests"],"public":["/auth","/student-auth","/tests/csi/public"],"timestamp":"2025-03-04T21:41:19.282Z"}
{"level":"info","message":"Server in esecuzione su localhost:5000","timestamp":"2025-03-04T21:41:19.292Z"}
{"level":"info","message":"Ambiente: development","timestamp":"2025-03-04T21:41:19.293Z"}
{"entriesCount":16,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:41:22.785Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":16,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:41:22.786Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:41:39.055Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:41:39.056Z","userId":"677bfe44f6789c907c9f3766"}
{"error":{"message":"Token non più valido","metadata":{}},"level":"error","message":"Logout error","timestamp":"2025-03-04T21:41:42.244Z"}
{"error":{"message":"Token non più valido","metadata":{}},"level":"error","message":"Logout failed","timestamp":"2025-03-04T21:41:42.245Z"}
{"error":{},"level":"error","message":"Auth Route Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T21:41:42.245Z"}
{"error":{},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-04T21:41:42.247Z","userId":"677bfe44f6789c907c9f3766"}
{"duration":"63ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741124502186_g2si5ldd4","responseSize":"401 Bytes","statusCode":500,"timestamp":"2025-03-04T21:41:42.249Z","url":"/api/v1/auth/logout","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"level":"info","message":"Login successful","metadata":{"ipAddress":"::1","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"},"timestamp":"2025-03-04T21:41:46.216Z","userId":"677bfe44f6789c907c9f3766"}
{"action":"login","level":"info","message":"User audit record created","timestamp":"2025-03-04T21:41:46.249Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":1,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:41:52.835Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":1,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T21:41:52.836Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T22:03:16.372Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":0,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T22:03:16.374Z","userId":"67c5e8191af6a34321b52006"}
{"entriesCount":1,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T22:03:21.624Z","userId":"677bfe44f6789c907c9f3766"}
{"entriesCount":1,"level":"info","message":"User history retrieved","timestamp":"2025-03-04T22:03:21.626Z","userId":"677bfe44f6789c907c9f3766"}
{"level":"info","message":"Tipo scuola cambiato con successo:","newInstitutionType":"none","newType":"middle_school","schoolId":"679fdad474255ebc8afab683","timestamp":"2025-03-04T22:05:14.108Z","userId":"677bfe44f6789c907c9f3766"}
{"error":"fn is not a function","level":"error","message":"School Route Error:","method":"GET","path":"/679fdad474255ebc8afab683/transition-preview","role":"admin","stack":"TypeError: fn is not a function\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\yearTransitionRoutes.js:24:21\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\middleware\\authMiddleware.js:204:13\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-03-04T22:07:39.129Z","userId":"677bfe44f6789c907c9f3766"}
{"duration":"164ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"GET","requestId":"req_1741126058966_4fkbrmnkm","responseSize":"89 Bytes","statusCode":500,"timestamp":"2025-03-04T22:07:39.130Z","url":"/api/v1/schools/679fdad474255ebc8afab683/transition-preview?fromYear=2024%2F2025&toYear=2025%2F2026","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":"options is not defined","level":"error","message":"Errore nell'attivazione dell'anno accademico","schoolId":"679fdad474255ebc8afab683","stack":"ReferenceError: options is not defined\n    at SchoolRepository.activateAcademicYear (C:\\Users\\ricca\\Desktop\\BSc\\src\\repositories\\SchoolRepository.js:1612:21)\n    at SchoolController.activateAcademicYear (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\schoolController.js:1212:53)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-04T22:09:01.563Z","yearId":"67c755b1c5692f3176937273"}
{"duration":"131ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741126141434_1s82h4vif","responseSize":"86 Bytes","statusCode":500,"timestamp":"2025-03-04T22:09:01.565Z","url":"/api/v1/schools/679fdad474255ebc8afab683/academic-years/67c755b1c5692f3176937273/activate","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
{"error":"this.classRepository.find(...).session is not a function","level":"error","message":"Errore nell'archiviazione dell'anno accademico","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-04T22:09:39.346Z","yearId":"67c763375b0426e1cb851feb"}
{"error":"this.classRepository.find(...).session is not a function","level":"error","message":"Errore nell'archiviazione dell'anno accademico","schoolId":"67c763375b0426e1cb851fea","stack":"TypeError: this.classRepository.find(...).session is not a function\n    at SchoolRepository.archiveAcademicYear (C:\\Users\\ricca\\Desktop\\BSc\\src\\repositories\\SchoolRepository.js:1742:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async SchoolController.archiveAcademicYear (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\schoolController.js:1267:31)","timestamp":"2025-03-04T22:09:39.348Z","yearId":"67c763375b0426e1cb851feb"}
{"duration":"170ms","ip":"::1","level":"warn","message":"Risposta inviata","method":"POST","requestId":"req_1741126179179_pukb7n8mu","responseSize":"120 Bytes","statusCode":500,"timestamp":"2025-03-04T22:09:39.350Z","url":"/api/v1/schools/67c763375b0426e1cb851fea/academic-years/67c763375b0426e1cb851feb/archive","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 Edg/133.0.0.0"}
=======
>>>>>>> 457a2380b14293573ee634cdd7ba14f1f47b5d17
>>>>>>> 17a36497726bba5040f84fe88e83e9322e04a107
