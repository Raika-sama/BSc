<<<<<<< HEAD
{"error":"studentAuthService is not defined","level":"error","message":"Errore durante l'avvio del server:","stack":"ReferenceError: studentAuthService is not defined\n    at startServer (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\app.js:259:13)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-04T23:00:42.782Z"}
{"code":"AUTH_005","level":"error","message":"Solo i docenti possono accedere a questa risorsa","metadata":{},"status":403,"timestamp":"2025-03-04T23:37:27.703Z"}
{"error":"Solo i docenti possono accedere a questa risorsa","level":"error","message":"Student route error:","method":"GET","path":"/my-students","timestamp":"2025-03-04T23:37:27.705Z","userId":"67c02995250c5746c3d9647c"}
{"body":{},"error":{"message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741131447520_yw4srlzh3","timestamp":"2025-03-04T23:37:27.708Z","url":"/api/v1/students/my-students"}
{"level":"error","message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-03-04T23:37:27.710Z"}
{"code":"AUTH_005","level":"error","message":"Solo i docenti possono accedere a questa risorsa","metadata":{},"status":403,"timestamp":"2025-03-04T23:40:19.964Z"}
{"error":"Solo i docenti possono accedere a questa risorsa","level":"error","message":"Student route error:","method":"GET","path":"/my-students","timestamp":"2025-03-04T23:40:19.966Z","userId":"67c02995250c5746c3d9647c"}
{"body":{},"error":{"message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741131619792_d2q81qz6m","timestamp":"2025-03-04T23:40:19.967Z","url":"/api/v1/students/my-students"}
{"level":"error","message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-03-04T23:40:19.968Z"}
{"error":"Parametro di ricerca richiesto","level":"error","message":"Student route error:","method":"GET","path":"/search","timestamp":"2025-03-04T23:40:26.772Z","userId":"67c02995250c5746c3d9647c"}
{"code":"AUTH_005","level":"error","message":"Solo i docenti possono accedere a questa risorsa","metadata":{},"status":403,"timestamp":"2025-03-04T23:40:35.705Z"}
{"error":"Solo i docenti possono accedere a questa risorsa","level":"error","message":"Student route error:","method":"GET","path":"/my-students","timestamp":"2025-03-04T23:40:35.705Z","userId":"67c02995250c5746c3d9647c"}
{"body":{},"error":{"message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741131635501_boafoe6ce","timestamp":"2025-03-04T23:40:35.706Z","url":"/api/v1/students/my-students"}
{"level":"error","message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-03-04T23:40:35.707Z"}
{"code":"AUTH_005","level":"error","message":"Solo i docenti possono accedere a questa risorsa","metadata":{},"status":403,"timestamp":"2025-03-04T23:40:37.187Z"}
{"error":"Solo i docenti possono accedere a questa risorsa","level":"error","message":"Student route error:","method":"GET","path":"/my-students","timestamp":"2025-03-04T23:40:37.188Z","userId":"67c02995250c5746c3d9647c"}
{"body":{},"error":{"message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741131637014_79wrefvhv","timestamp":"2025-03-04T23:40:37.189Z","url":"/api/v1/students/my-students"}
{"level":"error","message":"Cannot read properties of undefined (reading 'code')","stack":"TypeError: Cannot read properties of undefined (reading 'code')\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:181:72\n    at Layer.handle_error (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:71:5)\n    at trim_prefix (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:326:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at next (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\route.js:141:14)\n    at StudentController.getMyStudents (C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\controllers\\studentController.js:313:13)\n    at C:\\Users\\hanga\\Desktop\\BrainScanner\\src\\routes\\studentRoutes.js:28:25\n    at Layer.handle [as handle_request] (C:\\Users\\hanga\\Desktop\\BrainScanner\\node_modules\\express\\lib\\router\\layer.js:95:5)","timestamp":"2025-03-04T23:40:37.190Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T05:42:50.520Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T05:42:50.522Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T05:42:50.533Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T05:42:50.534Z"}
=======
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T07:22:46.242Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T07:22:46.243Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T07:22:46.363Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T07:22:46.371Z"}
{"error":"fn is not a function","level":"error","message":"School Route Error:","method":"GET","path":"/679fdad474255ebc8afab683/transition-preview","role":"admin","stack":"TypeError: fn is not a function\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\yearTransitionRoutes.js:24:21\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\middleware\\authMiddleware.js:204:13\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-03-05T07:28:06.907Z","userId":"677bfe44f6789c907c9f3766"}
{"error":"fn is not a function","level":"error","message":"School Route Error:","method":"GET","path":"/679fdad474255ebc8afab683/transition-preview","role":"admin","stack":"TypeError: fn is not a function\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\routes\\yearTransitionRoutes.js:24:21\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\middleware\\authMiddleware.js:204:13\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\express\\lib\\router\\index.js:346:12)","timestamp":"2025-03-05T07:49:19.947Z","userId":"677bfe44f6789c907c9f3766"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/679fdad474255ebc8afab683/transition-preview","timestamp":"2025-03-05T08:38:31.025Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"fromYear":"2024/2025","toYear":"2025/2026"},"requestId":"req_1741163911022_vanuyuyek","timestamp":"2025-03-05T08:38:31.027Z","url":"/api/v1/schools/679fdad474255ebc8afab683/transition-preview?fromYear=2024%2F2025&toYear=2025%2F2026"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-05T08:38:31.028Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T08:38:38.225Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T08:38:38.228Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T08:38:38.265Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T08:38:38.268Z"}
{"error":"Class constructor ObjectId cannot be invoked without 'new'","level":"error","message":"Error in year transition preview","stack":"TypeError: Class constructor ObjectId cannot be invoked without 'new'\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:124:32\n    at Set.forEach (<anonymous>)\n    at YearTransitionController.getTransitionPreview (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:119:16)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-05T09:30:17.658Z"}
{"error":"Class constructor ObjectId cannot be invoked without 'new'","level":"error","message":"School Route Error:","method":"GET","path":"/67c454061dbaba04e72dc2ec/transition-preview","role":"admin","stack":"TypeError: Class constructor ObjectId cannot be invoked without 'new'\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:124:32\n    at Set.forEach (<anonymous>)\n    at YearTransitionController.getTransitionPreview (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:119:16)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-05T09:30:17.660Z","userId":"677bfe44f6789c907c9f3766"}
{"error":"Class constructor ObjectId cannot be invoked without 'new'","level":"error","message":"Error in year transition preview","stack":"TypeError: Class constructor ObjectId cannot be invoked without 'new'\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:124:32\n    at Set.forEach (<anonymous>)\n    at YearTransitionController.getTransitionPreview (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:119:16)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-05T09:30:28.166Z"}
{"error":"Class constructor ObjectId cannot be invoked without 'new'","level":"error","message":"School Route Error:","method":"GET","path":"/67c454061dbaba04e72dc2ec/transition-preview","role":"admin","stack":"TypeError: Class constructor ObjectId cannot be invoked without 'new'\n    at C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:124:32\n    at Set.forEach (<anonymous>)\n    at YearTransitionController.getTransitionPreview (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\yearTransitionController.js:119:16)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-05T09:30:28.168Z","userId":"677bfe44f6789c907c9f3766"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/67c454061dbaba04e72dc2ec/transition-preview","timestamp":"2025-03-05T09:40:08.585Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"fromYear":"2024/2025","toYear":"2025/2026"},"requestId":"req_1741167608579_it4tctsu7","timestamp":"2025-03-05T09:40:08.587Z","url":"/api/v1/schools/67c454061dbaba04e72dc2ec/transition-preview?fromYear=2024%2F2025&toYear=2025%2F2026"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-05T09:40:08.589Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/67c454061dbaba04e72dc2ec/transition-preview","timestamp":"2025-03-05T09:40:30.609Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"fromYear":"2024/2025","toYear":"2025/2026"},"requestId":"req_1741167630601_rsdr6qqed","timestamp":"2025-03-05T09:40:30.612Z","url":"/api/v1/schools/67c454061dbaba04e72dc2ec/transition-preview?fromYear=2024%2F2025&toYear=2025%2F2026"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-05T09:40:30.613Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T09:40:41.631Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T09:40:41.633Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T09:40:41.645Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T09:40:41.646Z"}
{"error":"this.classRepository.find(...).session is not a function","level":"error","message":"Errore nell'archiviazione dell'anno accademico","schoolId":"67c454061dbaba04e72dc2ec","timestamp":"2025-03-05T09:44:02.061Z","yearId":"67c454061dbaba04e72dc2ed"}
{"error":"this.classRepository.find(...).session is not a function","level":"error","message":"Errore nell'archiviazione dell'anno accademico","schoolId":"67c454061dbaba04e72dc2ec","stack":"TypeError: this.classRepository.find(...).session is not a function\n    at SchoolRepository.archiveAcademicYear (C:\\Users\\ricca\\Desktop\\BSc\\src\\repositories\\SchoolRepository.js:1742:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async SchoolController.archiveAcademicYear (C:\\Users\\ricca\\Desktop\\BSc\\src\\controllers\\schoolController.js:1267:31)","timestamp":"2025-03-05T09:44:02.062Z","yearId":"67c454061dbaba04e72dc2ed"}
{"error":"Anno accademico già presente","level":"error","message":"Error in setupAcademicYear:","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-05T10:26:23.492Z","yearData":{"createdBy":"677bfe44f6789c907c9f3766","endDate":"2025-06-30","startDate":"2024-09-01","status":"planned","year":"2024/2025"}}
{"error":"Anno accademico già presente","level":"error","message":"Errore nella creazione dell'anno accademico","schoolId":"67c763375b0426e1cb851fea","timestamp":"2025-03-05T10:26:23.493Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T10:43:57.512Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T10:43:57.515Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T10:43:57.578Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T10:43:57.580Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/","timestamp":"2025-03-05T16:21:03.300Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"limit":"25","page":"1","search":"","sort":"-createdAt"},"requestId":"req_1741191663288_ggqerlfw6","timestamp":"2025-03-05T16:21:03.306Z","url":"/api/v1/users?page=1&limit=25&search=&sort=-createdAt"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-05T16:21:03.308Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T16:21:28.159Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T16:21:28.160Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T16:21:28.177Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T16:21:28.178Z"}
{"error":"I campi testType e classId sono obbligatori","level":"error","message":"Error in class test assignment:","timestamp":"2025-03-05T17:04:08.264Z"}
{"error":"I campi testType e classId sono obbligatori","level":"error","message":"Error in class test assignment:","timestamp":"2025-03-05T17:04:12.961Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/unassigned/679fdad474255ebc8afab683","timestamp":"2025-03-05T17:22:24.707Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{},"requestId":"req_1741195341777_tr04mzfn9","timestamp":"2025-03-05T17:22:24.871Z","url":"/api/v1/students/unassigned/679fdad474255ebc8afab683"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-05T17:22:25.005Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/","timestamp":"2025-03-05T17:22:26.445Z"}
{"body":{},"error":{"message":"Autenticazione richiesta"},"level":"error","message":"Errore richiesta","method":"GET","query":{"limit":"25","page":"1","search":"","sort":"-createdAt"},"requestId":"req_1741195346441_nmwi14jbg","timestamp":"2025-03-05T17:22:26.448Z","url":"/api/v1/users?page=1&limit=25&search=&sort=-createdAt"}
{"level":"error","message":"Autenticazione richiesta","timestamp":"2025-03-05T17:22:26.450Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T17:22:30.876Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T17:22:30.879Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T17:22:30.902Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T17:22:30.904Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/verify","timestamp":"2025-03-05T18:47:36.796Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"GET","path":"/api/v1/auth/verify","timestamp":"2025-03-05T18:47:36.804Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Authentication failed","path":"/logout","timestamp":"2025-03-05T18:47:36.844Z"}
{"error":{"message":"Autenticazione richiesta","metadata":{}},"ip":"::1","level":"error","message":"Auth Error:","method":"POST","path":"/api/v1/auth/logout","timestamp":"2025-03-05T18:47:36.845Z"}
{"error":"E11000 duplicate key error collection: brainScannerDB.classes index: schoolId_1_year_1_section_1_academicYear_1 dup key: { schoolId: ObjectId('679fdad474255ebc8afab683'), year: 1, section: \"A\", academicYear: \"2024/2025\" }","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"MongoBulkWriteError: E11000 duplicate key error collection: brainScannerDB.classes index: schoolId_1_year_1_section_1_academicYear_1 dup key: { schoolId: ObjectId('679fdad474255ebc8afab683'), year: 1, section: \"A\", academicYear: \"2024/2025\" }\n    at OrderedBulkOperation.handleWriteError (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\node_modules\\mongodb\\lib\\bulk\\common.js:860:22)\n    at resultHandler (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\node_modules\\mongodb\\lib\\bulk\\common.js:350:27)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\node_modules\\mongodb\\lib\\utils.js:297:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-05T19:19:55.475Z","yearId":"679fdad474255ebc8afab684"}
{"code":11000,"insertedDocs":[],"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","result":{"deletedCount":0,"insertedCount":0,"insertedIds":{},"matchedCount":0,"modifiedCount":0,"upsertedCount":0,"upsertedIds":{}},"timestamp":"2025-03-05T19:19:55.477Z","writeErrors":[{"err":{"code":11000,"errmsg":"E11000 duplicate key error collection: brainScannerDB.classes index: schoolId_1_year_1_section_1_academicYear_1 dup key: { schoolId: ObjectId('679fdad474255ebc8afab683'), year: 1, section: \"A\", academicYear: \"2024/2025\" }","index":0,"op":{"__v":0,"_id":"67c8a3dbaba171945cb1d8a1","academicYear":"2024/2025","capacity":25,"createdAt":"2025-03-05T19:19:55.257Z","isActive":true,"mainTeacherIsTemporary":false,"schoolId":"679fdad474255ebc8afab683","section":"A","status":"planned","students":[],"teachers":[],"updatedAt":"2025-03-05T19:19:55.426Z","year":1}},"index":0}]}
{"error":"Class validation failed: section: temp-B non è una sezione valida","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"ValidationError: Class validation failed: section: temp-B non è una sezione valida\n    at Document.invalidate (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3219:32)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3012:17\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\schematype.js:1368:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-03-05T19:20:39.097Z","yearId":"679fdad474255ebc8afab684"}
{"_message":"Class validation failed","errors":{"section":{"kind":"user defined","message":"temp-B non è una sezione valida","name":"ValidatorError","path":"section","properties":{"message":"temp-B non è una sezione valida","path":"section","type":"user defined","value":"temp-B"},"value":"temp-B"}},"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","timestamp":"2025-03-05T19:20:39.099Z"}
{"error":"E11000 duplicate key error collection: brainScannerDB.classes index: schoolId_1_year_1_section_1_academicYear_1 dup key: { schoolId: ObjectId('679fdad474255ebc8afab683'), year: 1, section: \"A\", academicYear: \"2024/2025\" }","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"MongoBulkWriteError: E11000 duplicate key error collection: brainScannerDB.classes index: schoolId_1_year_1_section_1_academicYear_1 dup key: { schoolId: ObjectId('679fdad474255ebc8afab683'), year: 1, section: \"A\", academicYear: \"2024/2025\" }\n    at OrderedBulkOperation.handleWriteError (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\node_modules\\mongodb\\lib\\bulk\\common.js:860:22)\n    at resultHandler (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\node_modules\\mongodb\\lib\\bulk\\common.js:350:27)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\node_modules\\mongodb\\lib\\utils.js:297:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-03-05T19:23:46.684Z","yearId":"679fdad474255ebc8afab684"}
{"code":11000,"insertedDocs":[],"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","result":{"deletedCount":0,"insertedCount":0,"insertedIds":{},"matchedCount":0,"modifiedCount":0,"upsertedCount":0,"upsertedIds":{}},"timestamp":"2025-03-05T19:23:46.685Z","writeErrors":[{"err":{"code":11000,"errmsg":"E11000 duplicate key error collection: brainScannerDB.classes index: schoolId_1_year_1_section_1_academicYear_1 dup key: { schoolId: ObjectId('679fdad474255ebc8afab683'), year: 1, section: \"A\", academicYear: \"2024/2025\" }","index":0,"op":{"__v":0,"_id":"67c8a4c2a0e58d84fb4ecb48","academicYear":"2024/2025","capacity":25,"createdAt":"2025-03-05T19:23:46.445Z","isActive":true,"mainTeacherIsTemporary":false,"schoolId":"679fdad474255ebc8afab683","section":"A","status":"planned","students":[],"teachers":[],"updatedAt":"2025-03-05T19:23:46.628Z","year":1}},"index":0}]}
{"error":"Class validation failed: section: temp-B non è una sezione valida","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"ValidationError: Class validation failed: section: temp-B non è una sezione valida\n    at Document.invalidate (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3219:32)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3012:17\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\schematype.js:1368:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-03-05T19:28:13.101Z","yearId":"679fdad474255ebc8afab684"}
{"_message":"Class validation failed","errors":{"section":{"kind":"user defined","message":"temp-B non è una sezione valida","name":"ValidatorError","path":"section","properties":{"message":"temp-B non è una sezione valida","path":"section","type":"user defined","value":"temp-B"},"value":"temp-B"}},"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","timestamp":"2025-03-05T19:28:13.103Z"}
{"error":"Class validation failed: section: temp-C non è una sezione valida","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"ValidationError: Class validation failed: section: temp-C non è una sezione valida\n    at Document.invalidate (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3219:32)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3012:17\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\schematype.js:1368:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-03-05T19:30:39.238Z","yearId":"679fdad474255ebc8afab684"}
{"_message":"Class validation failed","errors":{"section":{"kind":"user defined","message":"temp-C non è una sezione valida","name":"ValidatorError","path":"section","properties":{"message":"temp-C non è una sezione valida","path":"section","type":"user defined","value":"temp-C"},"value":"temp-C"}},"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","timestamp":"2025-03-05T19:30:39.241Z"}
{"error":"Class validation failed: section: temp-C non è una sezione valida","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"ValidationError: Class validation failed: section: temp-C non è una sezione valida\n    at Document.invalidate (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3219:32)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3012:17\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\schematype.js:1368:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-03-05T19:30:44.730Z","yearId":"679fdad474255ebc8afab684"}
{"_message":"Class validation failed","errors":{"section":{"kind":"user defined","message":"temp-C non è una sezione valida","name":"ValidatorError","path":"section","properties":{"message":"temp-C non è una sezione valida","path":"section","type":"user defined","value":"temp-C"},"value":"temp-C"}},"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","timestamp":"2025-03-05T19:30:44.731Z"}
{"error":"Class validation failed: section: temp-C non è una sezione valida","level":"error","message":"Error updating academic year:","schoolId":"679fdad474255ebc8afab683","stack":"ValidationError: Class validation failed: section: temp-C non è una sezione valida\n    at Document.invalidate (C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3219:32)\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\document.js:3012:17\n    at C:\\Users\\ricca\\Desktop\\BSc\\node_modules\\mongoose\\lib\\schematype.js:1368:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)","timestamp":"2025-03-05T19:31:04.880Z","yearId":"679fdad474255ebc8afab684"}
{"_message":"Class validation failed","errors":{"section":{"kind":"user defined","message":"temp-C non è una sezione valida","name":"ValidatorError","path":"section","properties":{"message":"temp-C non è una sezione valida","path":"section","type":"user defined","value":"temp-C"},"value":"temp-C"}},"level":"error","message":"Errore nell'aggiornamento dell'anno accademico:","timestamp":"2025-03-05T19:31:04.881Z"}
{"error":"ID scuola non valido","level":"error","message":"Error in SchoolRepository.findById:","timestamp":"2025-03-05T20:18:55.589Z","type":"undefined"}
{"error":"ID scuola non valido","level":"error","message":"Errore nel recupero della scuola:","timestamp":"2025-03-05T20:18:55.596Z"}
{"error":"ID scuola non valido","level":"error","message":"Error in SchoolRepository.findById:","timestamp":"2025-03-05T20:19:13.239Z","type":"undefined"}
{"error":"ID scuola non valido","level":"error","message":"Errore nel recupero della scuola:","timestamp":"2025-03-05T20:19:13.240Z"}
>>>>>>> aa0498b4ddafee4cf0da9f8b1cc8fc5309af7611
